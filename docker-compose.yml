services:
  browserless:
    image: browserless/chrome:${BROWSERLESS_TAG}
    container_name: browserless-chrome
    restart: unless-stopped
    environment:
      - MAX_CONCURRENT_SESSIONS=${BROWSERLESS_MAX_CONCURRENT}
      - QUEUE_LENGTH=${BROWSERLESS_QUEUE_LENGTH}
      - PREBOOT_CHROME=${BROWSERLESS_PREBOOT}
      - CHROME_REFRESH_TIME=${BROWSERLESS_REFRESH_INTERVAL}
      - ENABLE_DEBUGGER=${BROWSERLESS_ENABLE_DEBUGGER}
      - DEFAULT_BLOCK_ADS=${BROWSERLESS_BLOCK_ADS}
      - SCREEN_WIDTH=${BROWSERLESS_SCREEN_WIDTH}
      - SCREEN_HEIGHT=${BROWSERLESS_SCREEN_HEIGHT}
      - SCREEN_DEPTH=${BROWSERLESS_SCREEN_DEPTH}
      - TOKEN=${BROWSERLESS_TOKEN}
    volumes:
      - ./logs:/home/browserless/logs
      - ./browserless-data:/data
    networks:
      - ${GRID_NETWORK}

  nginx:
    image: nginx:alpine
    container_name: browserless-nginx
    restart: unless-stopped
    depends_on:
      - browserless
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    networks:
      - ${GRID_NETWORK}

networks:
  browserless:
    name: ${GRID_NETWORK}
    driver: bridge
